package main

// MalwareSourcer interface
// Represents the necessary functions for each malware source
type MalwareSourcer interface {
	FindFile(*Sample)
	DownloadFile(Sample) bool

	GetCanDownload() bool
	GetHasFile() bool
	GetName() string
	GetURL() string
}

// MalwareSource struct
// if HasFile is true, the source has the file
// if CanDownload is true, we are able to download the file from the source
// if HasFile is false, CanDownload must be false
// Name is name of source (i.e. "VirusTotal")
// URL is the link to the file on the source website
type MalwareSource struct {
	HasFile     bool
	CanDownload bool
	Name        string
	URL         string
}

// GetCanDownload returns the struct member CanDownload value
func (m MalwareSource) GetCanDownload() bool {
	return m.CanDownload
}

// GetHasFile returns the struct member GetHasFile value
func (m MalwareSource) GetHasFile() bool {
	return m.HasFile
}

// GetName returns the struct member Name value
func (m MalwareSource) GetName() string {
	return m.Name
}

// GetURL returns the struct member URL value
func (m MalwareSource) GetURL() string {
	return m.URL
}

// Sample struct
// Tracks different hashes in order to enable the most amount of sources (some require certain hash types)
type Sample struct {
	MD5      string
	SHA1     string
	SHA256   string
	UserHash string // original hash specified by the user, this field is used if a specific type isn't required
}

// SearchResult struct
// Tracks returns from various sources for a single file
type SearchResult struct {
	Sample     Sample
	URLs       []string
	Downloaded bool
}
